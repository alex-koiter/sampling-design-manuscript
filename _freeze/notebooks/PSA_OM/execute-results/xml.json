{
  "hash": "87027719ad9e08c0e186dbad96f42eeb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Plotting SSA and SOM\nauthor: Alex Koiter\n---\n\n\n\n\n\n\n\n\n\n  \n## Load Libraries\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: viridisLite\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(patchwork)\n```\n:::\n\n\n\n\n\n\n\n\n\n\n## Load data\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\npsa <- read.csv(here::here(\"./notebooks/PSA_data.csv\")) %>%\n  rename(site = Site) %>%\n  select(site, sample_number, sampling_design, dx_50, specific_surface_area) %>%\n  filter(sampling_design != \"Fine scale\") %>%\n  mutate(sampling_design = fct_relevel(sampling_design, \"Grid\" , \"Transect\",\"Likely to erode\")) %>%\n  mutate(sig_letter = case_when(site == \"Agriculture\" ~ \"a\",\n                                site == \"Forest\" ~ \"b\")) %>%\n  group_by(site, sampling_design) %>%\n  mutate(ymax = max(specific_surface_area)+60)\n\nom <- read.csv(here::here(\"./notebooks/OM_data.csv\")) %>%\n  rename(site = Site, sampling_design = Sampling_Design, sample_number = Sample_Number) %>%\n  select(OM, site, sampling_design, sample_number) %>%\n  filter(sampling_design != \"Fine scale\") %>%\n  mutate(site = recode(site, Agricultural = \"Agriculture\")) %>%\n  mutate(sampling_design = fct_relevel(sampling_design, \"Grid\" , \"Transect\",\"Likely to erode\")) %>%\n  mutate(sig_letter = case_when(site == \"Agriculture\" ~ \"a\",\n                                site == \"Forest\" ~ \"b\")) %>%\n  group_by(site, sampling_design) %>%\n  mutate(ymax = max(OM)+1)\n```\n:::\n\n\n\n\n\n\n\n\n\n\n\n## Stats\n\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nwilcox.test(specific_surface_area ~ site, data = filter(psa, sampling_design == \"Grid\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  specific_surface_area by site\nW = 2450, p-value < 2.2e-16\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nwilcox.test(specific_surface_area ~ site, data = filter(psa, sampling_design == \"Transect\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  specific_surface_area by site\nW = 196, p-value = 4.985e-08\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nwilcox.test(specific_surface_area ~ site, data = filter(psa, sampling_design == \"Likely to erode\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  specific_surface_area by site\nW = 64, p-value = 0.0001554\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nwilcox.test(OM ~ site, data = filter(om, sampling_design == \"Grid\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  OM by site\nW = 779, p-value = 0.002526\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nwilcox.test(OM ~ site, data = filter(om, sampling_design == \"Transect\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  OM by site\nW = 49, p-value = 0.02412\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nwilcox.test(OM ~ site, data = filter(om, sampling_design == \"Likely to erode\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum exact test\n\ndata:  OM by site\nW = 64, p-value = 0.0001554\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n## Plotting\n\n\n\n\n\n\n\n\n\n::: {#cell-fig-ssasom-plot .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-ssasom-plot\n#| fig-cap: \"Specific surface area and soil organic matter for the agricultural and forested sites as determined by the three sampling designs.\"\np1 <- ggplot(data = psa, aes(x = sampling_design, y = specific_surface_area, fill = site)) +\n  geom_boxplot() +\n    geom_text(data = select(psa, sampling_design, ymax, sig_letter) |> distinct(), \n            position = position_dodge(width = 0.75), aes(y = ymax, label = sig_letter, group = site), size = 2.5) +\n  theme_bw(base_size = 10) +\n  scale_y_continuous(expand =c(0,0), limits = c(250, 2500), breaks = seq(0, 2500, 500)) +\n  labs(y = expression(paste(\"Specific Surface Area (\", m^2*~kg^{-1}, \")\"))) +\n  theme(axis.title.x = element_blank(),\n        legend.title = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust=1),\n        legend.position = \"none\") +\n  scale_fill_viridis(discrete = TRUE, begin = 0, end = 0.6)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAdding missing grouping variables: `site`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-ssasom-plot\n#| fig-cap: \"Specific surface area and soil organic matter for the agricultural and forested sites as determined by the three sampling designs.\"\np2 <- ggplot(data = om, aes(x = sampling_design, y = OM, fill = site)) +\n  geom_boxplot() +\n  geom_text(data = select(om, sampling_design, ymax, sig_letter) |> distinct(), \n            position = position_dodge(width = 0.75), aes(y = ymax, label = sig_letter, group = site), size = 2.5) +\n  theme_bw(base_size = 10) +\n  scale_y_continuous(expand =c(0,0), limits = c(0, 30), breaks = seq(0, 30, 5)) +\n  labs(y = \"Organic Matter (%)\") +\n  theme(axis.title.x = element_blank(),\n        legend.title = element_blank(),\n        axis.text.x = element_text(angle = 45, hjust=1)) +\n  scale_fill_viridis(discrete = TRUE, begin = 0, end = 0.6)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAdding missing grouping variables: `site`\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: fig-ssasom-plot\n#| fig-cap: \"Specific surface area and soil organic matter for the agricultural and forested sites as determined by the three sampling designs.\"\np3 <- p1 +p2 + \n  plot_layout(guides = 'collect') & theme(legend.position =\"top\")\np3\n\n#ggsave(filename = here::here(\"./images/OM_PSA.png\"), plot = p3, height = 80,  width = 84, units = \"mm\", dpi = 600)\n```\n\n::: {.cell-output-display}\n![Specific surface area and soil organic matter for the agricultural and forested sites as determined by the three sampling designs.](PSA_OM_files/figure-jats/fig-ssasom-plot-1.png){#fig-ssasom-plot}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n## Summary\n\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nom %>%\n  full_join(psa) %>%\n  pivot_longer(cols = c(specific_surface_area, OM, dx_50), names_to = \"property\", values_to = \"value\") %>%\n  group_by(sampling_design, site, property) %>%\n  summarise(avg = round(mean(value), 1),\n            sd = round(sd(value), 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nJoining with `by = join_by(site, sampling_design, sample_number, sig_letter,\nymax)`\n`summarise()` has grouped output by 'sampling_design', 'site'. You can override\nusing the `.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 18 × 5\n# Groups:   sampling_design, site [6]\n   sampling_design site        property                avg    sd\n   <fct>           <chr>       <chr>                 <dbl> <dbl>\n 1 Grid            Agriculture OM                       NA    NA\n 2 Grid            Agriculture dx_50                    NA    NA\n 3 Grid            Agriculture specific_surface_area    NA    NA\n 4 Grid            Forest      OM                       NA    NA\n 5 Grid            Forest      dx_50                    NA    NA\n 6 Grid            Forest      specific_surface_area    NA    NA\n 7 Transect        Agriculture OM                       NA    NA\n 8 Transect        Agriculture dx_50                    NA    NA\n 9 Transect        Agriculture specific_surface_area    NA    NA\n10 Transect        Forest      OM                       NA    NA\n11 Transect        Forest      dx_50                    NA    NA\n12 Transect        Forest      specific_surface_area    NA    NA\n13 Likely to erode Agriculture OM                       NA    NA\n14 Likely to erode Agriculture dx_50                    NA    NA\n15 Likely to erode Agriculture specific_surface_area    NA    NA\n16 Likely to erode Forest      OM                       NA    NA\n17 Likely to erode Forest      dx_50                    NA    NA\n18 Likely to erode Forest      specific_surface_area    NA    NA\n```\n\n\n:::\n:::\n",
    "supporting": [
      "PSA_OM_files/figure-jats"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}